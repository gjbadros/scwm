#
SHELL=/bin/sh

@SET_MAKE@

VPATH=@srcdir@
top_srcdir=@top_srcdir@
srcdir=@srcdir@
prefix=@prefix@
exec_prefix=@exec_prefix@
bin_dir=@exec_prefix@/bin
x_includes=@x_includes@
x_libraries=@x_libraries@
scwm_icons=@scwm_icons@
scwm_rc=@scwm_rc@
scwm_name=@scwm_name@
scwm_dir=@scwm_dir@
LDFLAGS=@LDFLAGS@
#
# This is where the modules will be installed


#
# Libs
X_LIBRARY=-lX11 @LIBS@
XEXT_LIBRARY=-lXext
XPM_LIBRARY=-lXpm
#SCWM_LIBRARY=-l${scwm_name} # removed from below line, too
LIBS=-L../libs ${x_libraries} ${XPM_LIBRARY} ${XEXT_LIBRARY} ${X_LIBRARY} ${LDFLAGS}

PATH_DEFINES=-DSCWM_ICONDIR=\"${scwm_icons}\" \
               -DSCWMDIR=\"${scwm_dir}\" \
               -DSCWMRC=\"${scwm_rc}\"

EXTRA_DEFINES=-DXPM -DSHAPE ${PATH_DEFINES} -DACTIVEDOWN_BTNS -DINACTIVE_BTNS -DMINI_ICONS -DVECTOR_BUTTONS -DPIXMAP_BUTTONS -DGRADIENT_BUTTONS -DMULTISTYLE -DEXTENDED_TITLESTYLE -DBORDERSTYLE -DUSEDECOR -DWINDOWSHADE


CC=@CC@
INCLUDES=-I../include -I${top_srcdir}/include ${x_includes} -I${prefix}/include
CFLAGS=${INCLUDES} @CFLAGS@ ${EXTRA_DEFINES}
MAKEDEPEND=@MAKEDEPEND@
INSTALL=@INSTALL@
INSTALL_PROGRAM=@INSTALL_PROGRAM@
RM=@RM@

PROG=${scwm_name}

HEADERS = $(wildcard *.h)

SRCS = \
        string_token.c \
	ICCCM.c \
	Picture.c \
	system.c \
	envvar.c \
	Grab.c \
	wildcard.c \
	add_window.c \
	borders.c \
	builtins.c \
	colormaps.c \
	colors.c \
	complex.c \
	decorations.c \
	events.c \
	focus.c \
	scwm.c \
	icons.c \
	menus.c \
	misc.c \
	move.c \
	placement.c \
	resize.c \
	virtual.c \
	scmprocs.c \
	scmtypes.c \
	font.c \
	color.c \
	miscprocs.c \
	binding.c \
	errors.c \
	util.c \
	window.c \
	menu.c \
	paths.c \
	deskpage.c \
	decor.c \
	face.c

OBJS := $(SRCS:.c=.o)
DEPS := $(SRCS:.c=.d)

all: ${PROG}

tags: $(SRCS) $(HEADERS)
	etags $^

depend:
	${MAKEDEPEND} ${CFLAGS} ${SRCS}

install: all
	${INSTALL_PROGRAM} ${PROG} ${bin_dir}

mostlyclean:
	${RM} ${OBJS} ${DEPS} *~ core *.bak

clean: mostlyclean
	${RM} ${PROG}

distclean: clean


${PROG}: ${OBJS}
	rm -f ${PROG}
	${CC} -o ${PROG} ${OBJS} ${LIBS}

%.d: %.c
	$(SHELL) -ec '$(CC) -M $(CFLAGS) $< \
		| sed '\''s/$*\\.o[ :]*/& $@/g'\'' > $@'

include ${DEPS}
